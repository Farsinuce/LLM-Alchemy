# LLM Alchemy - Bug Squashing & Refinement Plan (v6)

## 0. Getting Started for New Developers

### What is LLM Alchemy?
LLM Alchemy is a web-based alchemy game where players combine elements to discover new ones. Combinations are dynamically generated by an LLM (Google Gemini via OpenRouter), creating unique gameplay experiences.

**Live Game**: https://llm-alchemy-beta2.vercel.app  
**GitHub**: https://github.com/Farsinuce/LLM-Alchemy

### Tech Stack
- **Frontend**: Next.js 15, React, TypeScript, Tailwind CSS v4
- **Backend**: Next.js API Routes on Vercel Edge Functions
- **Database**: Supabase (PostgreSQL)
- **Deployment**: Vercel (auto-deploys from GitHub)
- **Testing**: Vitest (unit) + GitHub Actions (E2E)

### Development Workflow
- **Commit and push**: `git add . && git commit -m "Fix: [bug description]" && git push`
- **Test on live site**: Vercel auto-deploys within ~1 minute to https://llm-alchemy-beta2.vercel.app

**Important**: We do NOT build locally. All testing happens on the live Vercel deployment.


---

## 1. Overview

This document outlines a refined, developer-centric plan to address three critical user-facing bugs. It incorporates a deep analysis of the codebase to identify the true root causes and proposes robust, long-term solutions.

---

## 2. Active Bug Fixes

### 2.1. Bug X: "Clear" Animation is Incorrect

-   **Status**: **BUGGED**
-   **Priority**: **Medium**
-   **The Problem**: When the "Clear" button is pressed, elements in the mixing area fade out incorrectly (opacity goes from 0% to 100% instead of 100% to 0%) and do not perform the required zoom animation (`100% -> 110% -> 0%`).
-   **The Root Cause**: This is a two-part issue:
    1.  **Incorrect CSS**: The `@keyframes clear-zoom-fade` in `src/styles/animations.css` has the wrong values. It animates opacity to `0.5` midway through instead of holding it at `1` before fading out.
    2.  **Conflicting Inline Styles**: The mixing area elements in `LLMAlchemyRefactored.tsx` have an inline style of `transition: 'none'`. This CSS rule has higher specificity and overrides the `animate-clear-zoom-fade` class, preventing the keyframe animation from executing.
-   **The Solution**:
    1.  First, I will correct the `@keyframes` in `animations.css` to match the specified animation curve: `transform: scale(1) -> scale(1.1) -> scale(0)` and `opacity: 1 -> 1 -> 0`.
    2.  Second, I will update the `animateRemoval` function in `useGameAnimations.ts`. This function will be modified to temporarily remove the conflicting `transition: 'none'` style from the elements during the animation, allowing the corrected keyframes to apply properly.

### 2.2. New feature request: Hover modal only for premium players
Don't show the hover modal for elements discovered with the cheaper "Gemini Flash" LLM. We want to reward paying players (or API key players) with the feature of being able to see the reasoning modals. So when the cheap LLM has been used to discover a new element, that elements hover modal should simply just not be shown.

### 2.3. Support landscape mode for mobile
If the mobile is flipped into LANDSCAPE MODE, I want our game to be responsive in such a degree, that the entire top part of the game (the header: logo, element counter, back button, tokens, filter, achivements button, sorting, game mode) becomes hidden in a hamburger menu. NOT in default PORTRAIT mode, mind you - only in mobile landscape mode, when the full game can simply not be displayed in its full height (due to landscape mode), yet there is plenty of horizontal space. Furthermore, the element grid list and the mixing area should not be split horisontally, but VERTICALLY. This requires quite some well-thoughtout plan from you to achieve.

### 2.4 Testing emoji logic system
If I visit our https://llm-alchemy-beta2.vercel.app/test-openmoji and test our emoji conversion system, it works well most of the time. But occasionally it still fails.

Good: LLM-suggested unicode emoji: "üêã"; LLM title: "Narwhal"; Conversion to openmoji "[narwhal emoji]". It works fine, when the title is 1:1 identical with a PUA emoji in openmoji.

Bad (testing): My suggested unicode emoji: "üè≠"; LLM title: "Exhaust factory"; tags: "facility, co2"; Conversion to openmoji FAILS with this browser console error: Error resolving emoji: TypeError: can't access property "hexcode", e is undefined
    NextJS 9
684-f4e54b07556c370d.js:1:107922

Why? Openmoji do have a fitting emoji called "exhaust gases factory". How can we refine our openmoji system to not fail, and to successfully select the right emoji in this case - WITHOUT overcomplicating things?